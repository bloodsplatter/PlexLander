@using PlexLander.Models
@using PlexLander.ViewModels.Settings
@using PlexLander.HtmlHelpers
@model SettingsIndexViewModel
<div class="panel-heading">
    <h3>Plex</h3>
</div>
<div class="panel-body">
    <div class="form-group">
        @Html.LabelFor(m => m.PlexServerSettingsViewModel.IsEnabled)?
        @Html.ToggleSwitchFor(m => m.PlexServerSettingsViewModel.IsEnabled, disabled: true)
    </div>

    @if (Model.PlexServerSettingsViewModel.IsEnabled)
    {
        <div class="form-group" id="plexsettings-followup">
            @Html.LabelFor(m => m.PlexServerSettingsViewModel.Token)<text>: </text>
            @Model.PlexServerSettingsViewModel.Token<br />
            @Html.LabelFor(m => m.PlexServerSettingsViewModel.HasAuthentication)?

            @if (!Model.PlexServerSettingsViewModel.HasAuthentication)
            {
                <button type="button" class="btn btn-warning" onclick="showModal('#modalPlexAuthentication')">Authenticate</button>
            }
            else
            {
                <span class="glyphicon glyphicon-ok-circle"></span> <button class="btn btn-success" onclick="callAndRefresh('@Url.Action("RefreshPlexServers","Settings")')">Refresh Servers</button>
            }
        </div>
        @if (Model.PlexServerSettingsViewModel.PlexServers.Count > 0)
        {
            <h3>Plex Servers available</h3>
            <div>
                <ul>
                    @foreach (var server in Model.PlexServerSettingsViewModel.PlexServers)
                    {
                        <li><a href="@server.Url">@server.Name</a></li>
                    }
                </ul>
            </div>
        }
    }
</div>